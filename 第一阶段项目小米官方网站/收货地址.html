<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="css/主页面.css">
  <link rel="stylesheet" href="css/我的个人中心.css">
  <link href="bootstrap-3.3.7-dist/css/bootstrap.css" rel="stylesheet">
  <script src="js/user.js"></script>
  <script src="jquery-3.2.1.js"></script>
  <script src="bootstrap-3.3.7-dist/js/bootstrap.js"></script>
  <style>
    .a{
      width: 250px;height: 180px;background: white;
      float: left;
      margin-left: 15px;
      border: 1px solid gainsboro;
      position: relative;
      padding: 15px;
    }
    .onchange{
      position: absolute;
      right: 20px;
      bottom: 10px;
    }
    .success{
      border-color: #2b542c;
      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
    }
    .error{
      border-color: #843534;
      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
    }

  </style>
</head>
<body>
<nav class="mynav nav navbar-inverse">
  <div class="container mynav-container ">
    <div class="row ">
      <div class="nav navbar-nav col-lg-7">
        <a href="小米登录后主页面.html">小米商城</a>
        <a href="">MIUI</a>
        <a href="">米聊</a>
        <a href="">游戏</a>
        <a href="">多看阅读</a>
        <a href="">云服务</a>
        <a href="">金融</a>
        <a href="">米币</a>
        <a href="">小米商城手机版</a>
        <a href="">问题反馈</a>
        <a href="">Select Region</a>
      </div>
      <div class="nav navbar-nav " style="position: relative;right: -87px;">
        <a href="登录页.html" id="sub">登录</a>
        <a href="小米注册页面.html" id="zhuce">注册</a>
        <div class="btn-group" id="dropdown" >
          <a type="button" class="btn open" data-toggle="dropdown" id="geren">
            13285906921
          </a>
          <ul class="dropdown-menu" style="margin-top: 0;margin-left: -50px" >
            <li><a href="我的个人中心.html">个人中心</a></li>
            <li><a href="评价晒单.html"> 评价晒单</a></li>
            <li><a href="#"> 我的喜欢</a></li>
            <li><a href="小米账户.html"> 小米账户</a></li>
            <li><a href="登录页.html" class="tuichu"> 退出登录</a></li>
          </ul>
        </div>
        <a href="">我的订单</a>
        <a href="">消息通知</a>
        <a href="" class="mynav-last-a"><span class="glyphicon glyphicon-shopping-cart"></span>购物车</a>
      </div>
      <div class="gowuche">
        <ul class="gowuchebody"></ul>
        <div class="jiesuan"></div>
      </div>
    </div>
  </div>
</nav>
<nav class="nav navbar-default mynav2" style="margin-top: 20px">
  <div class="container">
    <div class="row">
      <div class="col-lg-1">
        <img src="images/milogo.png" alt="">
      </div>
      <div class="col-lg-8">
        <ul class="nav navbar-nav navbar-left list-top">
          <li class="li1"><a class="btn" role="button" data-toggle="collapse">小米手机</a></li>
          <li class="li1"><a href="">红米</a></li>
          <li class="li1"><a href="">平板 · 笔记本</a></li>
          <li class="li1"><a href="">电视</a></li>
          <li class="li1"><a href="">盒子影音</a></li>
          <li class="li1"><a href="">路由器</a></li>
          <li class="li1"><a href="">智能硬件</a></li>
          <li ><a href="">服务</a></li>
          <li><a href="">社区</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <div class="input-group " style="width: 262px;top: 5px;">
          <input type="text" class="form-control input-lg" style="border-radius:0;border-color: #ff6700">
             <span class="input-group-btn">
             <button class="btn btn-default btn-lg" type="button" style="border-radius:0;border-color: #ff6700"><span
               class="glyphicon glyphicon-search"></span></button>
             </span>
        </div>
      </div>
    </div>
  </div>
</nav>
<div class="container">
  <!--路径导航-->
  <div class="row gps" style="margin-top: 20px;">
    <ol class="breadcrumb">
      <li><a href="#">首页</a></li>
      <li class="active">收货地址</li>
    </ol>
  </div>
  <!--中间内容-->
  <div class="row contentbody">
    <div class="col-lg-2">
      <dl>
        <dt>订单中心</dt>
        <dd><a href="订单中心.html">我的订单</a></dd>
        <dd>意外保</dd>
        <dd>团购订单</dd>
        <dd><a href="评价晒单.html">评价晒单</a></dd>
        <dd>话费充值订单</dd>
        <dd>以旧换新订单</dd>
      </dl>
      <dl>
        <dt>个人中心</dt>
        <dd ><a href="我的个人中心.html">我的个人中心</a></dd>
        <dd>消息通知</dd>
        <dd>购买资格</dd>
        <dd>现金账户</dd>
        <dd>小米礼品卡</dd>
        <dd>现金券</dd>
        <dd>喜欢的商品</dd>
        <dd>优惠券</dd>
        <dd ><a href="收货地址.html" style="color: rgb(245,102,0);">收货地址</a> </dd>
      </dl>
      <dl>
        <dt>售后服务</dt>
        <dd>服务记录</dd>
        <dd>申请服务</dd>
        <dd>领取快递报销</dd>
      </dl>
      <dl>
        <dt>账户管理</dt>
        <dd><a href="小米账户.html">个人信息</a></dd>
        <dd><a href="小米账户.html">修改密码</a></dd>
        <dd>社区VIP认证</dd>
      </dl>
    </div>
    <div class="col-lg-10">
     <h2 style="margin: 0">收货地址</h2>
     <div class="row" >
       <div style="padding: 50px 40px 40px 20px" >
         <div style="width: 250px;height: 180px;background: white;float: left;border: 1px solid gainsboro;margin-left: 15px">
           <a href="#" class="tianjiadizhi" style="display: block; margin-top: 70px;margin-left: 70px">
             <img src="images/jia.png" alt="">
             <p >添加新地址</p>
           </a>
         </div>
         <div id="big" >


         </div>
       </div>
     </div>
    </div>
  </div>
</div>
<div id="myModal" class="modal fade " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog " role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">详细地址</h4>
      </div>
      <div class="modal-body">
        <form class="form-horizontal form">
          <div class="form-group">
            <label  class="col-sm-3 control-label ">姓名:</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="ipt1" placeholder="姓名">
            </div>
          </div>
          <div class="form-group">
            <label  class="col-sm-3 control-label ">手机号:</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="ipt2" placeholder="手机号">
            </div>
          </div>
          <div class="form-group">
            <label  class="col-sm-3 control-label ">邮政编码:</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="ipt3" placeholder="邮政编码">
            </div>
          </div>
          <div class="form-group">
            <div class="col-lg-4 ">
              <select id="province" class="form-control" name="province" onchange="doProvAndCityRelation();">
                <option id="choosePro" value="-1">请选择您所在省份</option>
                　</select>
            </div>
           <div class="col-lg-4">
             <select id="citys"  class="form-control" name="city" onchange="doCityAndCountyRelation();">
               　<option id='chooseCity' value='-1'>请选择您所在城市</option>
             </select>
           </div>
            <div class="col-lg-4">
              <select id="county" class="form-control" name="county">
                <option id='chooseCounty' value='-1'>请选择您所在区/县</option>
              </select>
            </div>

          </div>
          <div class="form-group ">
            <div class="col-lg-12">
              <textarea class="form-control"  type="text" id="textarea" name="user_adress" placeholder="详细地址，路名或街道名称，门牌号"></textarea>
            </div>
          </div>
          <p style="text-align: center;">
            <button type="button" class="btn btn-default save">确认保存</button>
          </p>

        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div id="myModal2" class="modal fade " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog " role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel1">详细地址</h4>
      </div>
      <div class="modal-body">
        <form class="form-horizontal form">
          <div class="form-group">
            <label  class="col-sm-3 control-label ">姓名:</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="ipt4" placeholder="姓名">
            </div>
          </div>
          <div class="form-group">
            <label  class="col-sm-3 control-label ">手机号:</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="ipt5" placeholder="手机号">
            </div>
          </div>
          <div class="form-group">
            <label  class="col-sm-3 control-label ">邮政编码:</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="ipt6" placeholder="邮政编码">
            </div>
          </div>
          <div class="form-group">
            <div class="col-lg-4 ">
              <select id="province1" class="form-control" name="province" onchange="doProvAndCityRelation1();">
                <option id="choosePro1" value="-1">请选择您所在省份</option>
                　</select>
            </div>
            <div class="col-lg-4">
              <select id="citys1"  class="form-control" name="city" onchange="doCityAndCountyRelation1();">
                　<option id='chooseCity1' value='-1'>请选择您所在城市</option>
              </select>
            </div>
            <div class="col-lg-4">
              <select id="county1" class="form-control" name="county">
                <option id='chooseCounty1' value='-1'>请选择您所在区/县</option>
              </select>
            </div>

          </div>
          <div class="form-group ">
            <div class="col-lg-12">
              <textarea class="form-control"  type="text" id="textarea1" name="user_adress" placeholder="详细地址，路名或街道名称，门牌号"></textarea>
            </div>
          </div>
          <p style="text-align: center;">
            <button type="button" class="btn btn-default xiugai">确认保存</button>
          </p>

        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="container-fluid" style="margin-top: 30px;">
  <div class="site-footer">
    <div class="container">
      <div class="footer-service">
        <ul class="list-service clearfix">
          <li class="pull-left"><a rel="nofollow" ><span class="glyphicon glyphicon-repeat"></span>预约维修服务</a></li>
          <li class="pull-left">|</li>
          <li class="pull-left"><a rel="nofollow"  ><span class="glyphicon glyphicon-repeat"></span>7天无理由退货</a></li>
          <li class="pull-left">|</li>
          <li class="pull-left"><a rel="nofollow" ><span class="glyphicon glyphicon-repeat"></span>15天免费换货</a></li>
          <li class="pull-left">|</li>
          <li class="pull-left"><a rel="nofollow" ><span class="glyphicon glyphicon-repeat"></span>满150元包邮</a></li>
          <li class="pull-left">|</li>
          <li class="pull-left"><a rel="nofollow" ><span class="glyphicon glyphicon-repeat"></span>520余家售后网点</a></li>
        </ul>
      </div>
      <div class="page-header"></div>
      <div class="footer-links clearfix">
        <dl class="col-links col-links-first pull-left">
          <dt>帮助中心</dt>
          <dd><a rel="nofollow" >账户管理</a></dd>
          <dd><a rel="nofollow">购物指南</a></dd>
          <dd><a rel="nofollow" >订单操作</a></dd>
        </dl>
        <dl class="col-links  pull-left">
          <dt>服务支持</dt>
          <dd><a rel="nofollow" >售后政策</a></dd>
          <dd><a rel="nofollow" >自助服务</a></dd>
          <dd><a rel="nofollow" >相关下载</a></dd>
        </dl>
        <dl class="col-links  pull-left">
          <dt>线下门店</dt>
          <dd><a rel="nofollow">小米之家</a></dd>
          <dd><a rel="nofollow" >服务网点</a></dd>
          <dd><a rel="nofollow" >零售网点</a></dd>
        </dl>
        <dl class="col-links  pull-left">
          <dt>关于小米</dt>
          <dd><a rel="nofollow" >了解小米</a></dd>
          <dd><a rel="nofollow" >加入小米</a></dd>
          <dd><a rel="nofollow" >联系我们</a></dd>
        </dl>
        <dl class="col-links  pull-left">
          <dt>关注我们</dt>
          <dd><a rel="nofollow" >新浪微博</a></dd>
          <dd><a rel="nofollow" >小米部落</a></dd>
          <dd><a rel="nofollow" href="#" data-toggle="modal" >官方微信</a></dd>
        </dl>
        <dl class="col-links  pull-left">
          <dt>特色服务</dt>
          <dd><a rel="nofollow" >F 码通道</a></dd>
          <dd><a rel="nofollow" >礼物码</a></dd>
          <dd><a rel="nofollow" >防伪查询</a></dd>
        </dl>
        <div class="col-contact text-center">
          <h3 class="phone">400-100-5678</h3>
          <p>
            周一至周日 8:00-18:00<br>（仅收市话费）
          </p>
          <a rel="nofollow" class="btn btn-line-primary btn-small" ><i class="iconfont"></i> 24小时在线客服</a>
        </div>
      </div>
    </div>
  </div>
  <div class="site-info">
    <div class="container">
      <div class="row">
        <div class="col-lg-8" style="margin-left: 230px;" >
          <div class="logo ir pull-left"><img src="images/milogo.png" alt=""></div>
          <div class="info-text ">
            <p class="sites">
              <a rel="nofollow" >小米商城</a>
              <span class="sep">|</span>
              <a rel="nofollow" >MIUI</a>
              <span class="sep">|</span>
              <a rel="nofollow">米聊</a>
              <span class="sep">|</span>
              <a rel="nofollow"  >多看书城</a>
              <span class="sep">|</span>
              <a rel="nofol">Select Region</a> </p>
            <p>@<a   title="mi.com"  >mi.com</a> 京ICP证110507号
              <a rel="nofollow" data-stat-id="f96685804376361a" >京ICP备10046444号</a>
              <a rel="nofollow">京公网安备11010802020134号 </a><a rel="nofollow" >京网文[2014]0059-0009号</a>
              <br> 违法和不良信息举报电话：185-0130-1238，本网站所列数据，除特殊说明，所有数据均出自我司实验室测试</p>
          </div>
        </div>
      </div>
    </div>
    <div class="slogan ir">探索黑科技，小米为发烧而生，世界因你而美丽</div>
  </div>
</div>
<script>
  var isLogin=store.get('isLogin',false);
  if(isLogin==true){
    $('#sub').hide();
    $('#zhuce').hide();
    $('#geren').show();
  }else{
    $('#sub').show();
    $('#zhuce').show();
    $('#geren').hide();
    $('.gowuchebody').text('');
    $('.jiesuan').text('购物车空空如也');
  }
  $('.tuichu').click(function () {
    if(isLogin==true){
      $('#sub').hide();
      $('#zhuce').hide();
      $('#geren').show();
    }else{
      $('#sub').show();
      $('#zhuce').show();
      $('#geren').hide();

    }
    store.remove('isLogin');

  });







  var ADDRESS_KEY = 'address';
  var addressList = store.get(ADDRESS_KEY,[]);
  var html = '';
  var $dl = $('#big');
  var address={};
  console.log(addressList);
  function createAddress(address) {
    html ='<dl class="a" > ' +
      '<dt><em >'+address.username+'</em> </dt> ' + '<dd >'+address.tel+'</dd> ' +
      '<dd >'+address.province+ '&nbsp;'+address.city+'&nbsp;'+address.country+'' + '<br>'+address.textarea+'('+address.email+')</dd> ' +
      '<div class="onchange" data-id="'+ address.id +'"> ' +
      '<a class="set" href="javascript:;"> 修改</a> <a class="remove" href="javascript:;">删除</a>' +
      ' </div> </dl>';
    return html;
  }
  for( var i=0;i<addressList.length;i++){
   html += createAddress(addressList[i]);
  }
  $dl.append(html);

$('.tianjiadizhi').click(function () {
  $('#myModal').modal('show');
});
$('.save').click(function () {
  if($('#ipt1').data('off')&&$('#ipt2').data('off')&&$('#ipt3').data('off')&&$('#textarea').val()!==''){
    var html='';
    var username=$('#ipt1').val();
    var tel=$('#ipt2').val();
    var email=$('#ipt3').val();
    var province=$('#province>option:checked').text();
    var city=$('#citys>option:checked').text();
    var country=$('#county>option:checked').text();
    var textarea=$('#textarea').val();

    var id = 1;
    if(addressList.length > 0){
      id = addressList[addressList.length - 1].id + 1;
    }
    var address = {
      "id":id,
      "username":username,
      "tel":tel,
      "email":email,
      "province":province,
      "city":city,
      "country":country,
      "textarea":textarea
    };
    addressList.push(address);
    store.update('address',addressList);
    $dl.append(createAddress(address));
    $('#myModal').modal('hide');
  }else{
    alert('请在输入框中输入合适的值');
    return false;
  }
});






  $dl.on('click','.remove',function () {
    var sure=confirm('确定要删除么');
    if(sure=true){
      var id = $(this).parent().data('id');
      $(this).parent().parent().remove();
      for(var i=0;i<addressList.length;i++){
        if(addressList[i].id==id){
          addressList.splice(i,1);
          break;
        }
      }
      store.update(ADDRESS_KEY,addressList)
    }
  });
  $dl.on('click','.set',function () {
    $('#myModal2').modal('show');
    var id = $(this).parent().data('id');
    for(var i=0;i<addressList.length;i++){
      if(addressList[i].id==id){
         address = addressList[i]  ;
        break;
      }
    }
    $('#ipt4').val(address.username);
    $('#ipt5').val(address.tel);
    $('#ipt6').val(address.email);
    $('#province1>option:checked').text(address.province);
    $('#citys1>option:checked').text(address.city);
    $('#county1>option:checked').text(address.country);
    $('#textarea1').val(address.textarea);
    console.log(address);

  });
  function Focus(obj,str) {
    obj.show();
    obj.html(str).css( "color","gray")
  }
  function  Blur(obj,str1,str2) {
    if($(this).val()==''){
      $(this).next().html("不能为空").css( "color","red");
      $(this).removeClass("success");
      $(this).addClass("error ");
    }else if(obj.test($(this).val())){
      $(this).next().html(str1).css("color","green");
      $(this).addClass("success");
      $(this).removeClass("error ");
      $(this).data('off',true);
    }else{
      $(this).remove("success");
      $(this).addClass("error");
    }
  }



  $('#ipt1').blur(function () {
    Blur.call($(this), /^([a-zA-Z0-9\u4e00-\u9fa5\·]{2,10})$/,null,'输入正确','输入错误' );
  });
  $('#ipt2').blur(function () {
    Blur.call($(this),/^(?:13\d|15\d|18\d)\d{5}(\d{3}|\*{3})$/,null,'输入正确','输入错误' );
  });
  $('#ipt3').blur(function () {
    Blur.call($(this),/^[0-9]{6}$/ );
  });
  $('#ipt4').blur(function () {
    Blur.call($(this), /^([a-zA-Z0-9\u4e00-\u9fa5\·]{2,10})$/,null,'输入正确','输入错误' );
  });
  $('#ipt5').blur(function () {
    Blur.call($(this),/^(?:13\d|15\d|18\d)\d{5}(\d{3}|\*{3})$/,null,'输入正确','输入错误' );
  });
  $('#ipt6').blur(function () {
    Blur.call($(this),/^[0-9]{6}$/ );
  });


  $('.xiugai').click(function () {
    if($('#ipt5').val()&&$('#ipt4').val()&&$('#ipt6').val()&&$('#textarea1')!==''){
      address.username = $('#ipt4').val();
      address.tel = $('#ipt5').val();
      address.email= $('#ipt6').val();
      address.province= $('#province1>option:checked').text();
      address.city=$('#citys1>option:checked').text();
      address.country=$('#county1>option:checked').text();
      address.textarea=$('#textarea1').val();
      store.update(ADDRESS_KEY,addressList);
      var html='';
      html+= '<dt><em >'+address.username+'</em> </dt> ' + '<dd >'+address.tel+'</dd> ' +
        '<dd >'+address.province+ '&nbsp;'+address.city+'&nbsp;'+address.country+''
        + '<br>'+address.textarea+'('+address.email+')</dd> ' +
        '<div class="onchange" data-id="'+ address.id +'"> ' +
        '<a class="set" href="javascript:;"> 修改</a> <a class="remove" href="javascript:;">删除</a>' +
        ' </div>';
      $('[data-id='+address.id+']').parent().html(html);
      $('#myModal2').modal('hide');

      console.log(address.id);
    }else {
      alert('请在输入框中输入合适的值');
      return false;
    }





  });










var cityJson;
  var cityJson1;
  //load city.json
  $.getJSON("city.json", function (obj) {
      cityJson = obj;
      var sb = new StringBuffer();
      $.each(obj, function (i, val) {
        if (val.item_code.substr(2, 4) == '0000') {
          sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
        }
      });
      $("#choosePro").after(sb.toString());
    }
  );

// 省值变化时 处理市
function doProvAndCityRelation() {
  var city = $("#citys");
  var county = $("#county");
  if (city.children().length > 1) {
    city.empty();
  }
  if (county.children().length > 1) {
    county.empty();
  }
  if ($("#chooseCity").length == 0) {
    city.append("<option id='chooseCity' value='-1'>请选择您所在城市</option>");
  }
  if ($("#chooseCounty").length == 0) {
    county.append("<option id='chooseCounty' value='-1'>请选择您所在区/县</option>");
  }
  var sb = new StringBuffer();
  $.each(cityJson, function (i, val) {
    if (val.item_code.substr(0, 2) == $("#province").val().substr(0, 2) && val.item_code.substr(2, 4) != '0000' && val.item_code.substr(4, 2) == '00') {
      sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
    }
  });
  $("#chooseCity").after(sb.toString());
}
// 市值变化时 处理区/县
function doCityAndCountyRelation() {
  var cityVal = $("#citys").val();
  var county = $("#county");
  if (county.children().length > 1) {
    county.empty();
  }
  if ($("#chooseCounty").length == 0) {
    county.append("<option id='chooseCounty' value='-1'>请选择您所在区/县</option>");
  }
  var sb = new StringBuffer();
  $.each(cityJson, function (i, val) {
    if (cityVal == '110100' || cityVal == "120100" || cityVal == "310100" || cityVal == "500100") {
      if (val.item_code.substr(0, 3) == cityVal.substr(0, 3) && val.item_code.substr(4, 2) != '00') {
        sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
      }
    } else {
      if (val.item_code.substr(0, 4) == cityVal.substr(0, 4) && val.item_code.substr(4, 2) != '00') {
        sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
      }
    }
  });
  $("#chooseCounty").after(sb.toString());

}
function StringBuffer(str) {
  var arr = [];
  str = str || "";
  var size = 0;  // 存放数组大小
  arr.push(str);
  // 追加字符串
  this.append = function (str1) {
    arr.push(str1);
    return this;
  };
  // 返回字符串
  this.toString = function () {
    return arr.join("");
  };
  // 清空
  this.clear = function (key) {
    size = 0;
    arr = [];
  };
  // 返回数组大小
  this.size = function () {
    return size;
  };
  // 返回数组
  this.toArray = function () {
    return buffer;
  };
  // 倒序返回字符串
  this.doReverse = function () {
    var str = buffer.join('');
    str = str.split('');
    return str.reverse().join('');
  }
}




  $.getJSON("city.json", function (obj) {
      cityJson1 = obj;
      var sb = new StringBuffer();
      $.each(obj, function (i, val) {
        if (val.item_code.substr(2, 4) == '0000') {
          sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
        }
      });
      $("#choosePro1").after(sb.toString());
    }
  );
  function doProvAndCityRelation1() {
    var city = $("#citys1");
    var county = $("#county1");
    if (city.children().length > 1) {
      city.empty();
    }
    if (county.children().length > 1) {
      county.empty();
    }
    if ($("#chooseCity1").length == 0) {
      city.append("<option id='chooseCity1' value='-1'>请选择您所在城市</option>");
    }
    if ($("#chooseCounty1").length == 0) {
      county.append("<option id='chooseCounty1' value='-1'>请选择您所在区/县</option>");
    }
    var sb = new StringBuffer1();
    $.each(cityJson, function (i, val) {
      if (val.item_code.substr(0, 2) == $("#province1").val().substr(0, 2) && val.item_code.substr(2, 4) != '0000' && val.item_code.substr(4, 2) == '00') {
        sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
      }
    });
    $("#chooseCity1").after(sb.toString());
  }
  // 市值变化时 处理区/县
  function doCityAndCountyRelation1() {
    var cityVal = $("#citys1").val();
    var county = $("#county1");
    if (county.children().length > 1) {
      county.empty();
    }
    if ($("#chooseCounty1").length == 0) {
      county.append("<option id='chooseCounty1' value='-1'>请选择您所在区/县</option>");
    }
    var sb = new StringBuffer1();
    $.each(cityJson, function (i, val) {
      if (cityVal == '110100' || cityVal == "120100" || cityVal == "310100" || cityVal == "500100") {
        if (val.item_code.substr(0, 3) == cityVal.substr(0, 3) && val.item_code.substr(4, 2) != '00') {
          sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
        }
      } else {
        if (val.item_code.substr(0, 4) == cityVal.substr(0, 4) && val.item_code.substr(4, 2) != '00') {
          sb.append("<option value='" + val.item_code + "'>" + val.item_name + "</option>");
        }
      }
    });
    $("#chooseCounty1").after(sb.toString());

  }
  function StringBuffer1(str) {
    var arr = [];
    str = str || "";
    var size = 0;  // 存放数组大小
    arr.push(str);
    // 追加字符串
    this.append = function (str1) {
      arr.push(str1);
      return this;
    };
    // 返回字符串
    this.toString = function () {
      return arr.join("");
    };
    // 清空
    this.clear = function (key) {
      size = 0;
      arr = [];
    };
    // 返回数组大小
    this.size = function () {
      return size;
    };
    // 返回数组
    this.toArray = function () {
      return buffer;
    };
    // 倒序返回字符串
    this.doReverse = function () {
      var str = buffer.join('');
      str = str.split('');
      return str.reverse().join('');
    }
  }


</script>
<script>
  var username=store.get('userkey');
  var password=store.get('passkey');

  if(username){
    $('#sub').hide();
    $('#zhuce').hide();
    $('#geren').show();
  }
  $('#dropdown').hover(function () {
    $('#dropdown').addClass('open')

  },function () {
    $('#dropdown').removeClass('open')
  });
  $('.tuichu').click(function () {
    $('#sub').show();
    $('#zhuce').show();
    $('#geren').hide();
    $('.gowuchebody').text('');
    $('.jiesuan').text('购物车空空如也');
  });
  $.ajax({
    type: "GET",
    url: "gouwuche.json",
    dataType: "json",
    success: function (data) {
      console.log(data);
      var html = '';
      var html2 = '';
      var num = 0;
      var timer = null;
      for (var i = 0; i < data.length; i++) {
        html += '<li>';
        html += '<div><a href="" ><img src="' + data[i].image + '" alt="" ></a>';
        html += '<a href="">' + data[i].name + ' </a>';
        html += '<span  class="dd">' + data[i].price + '</span>';
        html += ' <a href="javascript:;" class="delete">&times;</a>';
        html += '</div></li>';
        num = num + parseInt(data[i].price);
      }
      len = data.length;
      html2 += '<span><span>共件<span class="bb">' + data.length + '' +
        '</span>商品<br> <span class="cc" style="font-size: 18px;color: #ff6700;" >' +
        num + '</span>元</span><button class="btn btn-danger btn-lg" style="float: right;margin-top: -20px">结算' +
        '</button></td></span>';
      $('.gowuche').find('.jiesuan').html(html2);
      $('.gowuche').find('ul').html(html)
        .find('.delete').on('click', function () {
        $(this).parents('li').remove();
        len--;
        $('.bb').text(len);
        num = num - parseInt($(this).parents('li').find('.dd').text());
        $('.cc').text(num);
      });
      $('.mynav-last-a').mouseover(function () {
        $('.gowuche').show();
      });
      $('.mynav-last-a').mouseout(function () {
        timer = setTimeout(function () {
          $('.gowuche').hide();
        }, 100);
      });
      $('.gowuche').mouseover(function () {
        clearTimeout(timer);
        $('.gowuche').show();
      });
      $('.gowuche').mouseout(function () {
        $('.gowuche').hide();
      })
    }
  });
</script>
</body>
</html>
